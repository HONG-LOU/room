import{v as h,E as _,d as g,r as v,a as x,q as V,e as t,w as n,f as r,b as p,o as k,g as y,l as m,i as f}from"./index-CplolMp0.js";import{r as F}from"./request-IMNDnQFT.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C=h("Pwd",{state:()=>({form:{password:"",new_password:"",check__new_password:""}}),actions:{validate_password(o,s,e){s===""?e(new Error("必须输入密码")):e()},validate_check_new_password(o,s,e){s===""?e(new Error("请重新输入新密码")):s!==this.form.new_password?e(new Error("2次输入的密码不一致!")):e()},validate_new_password(o,s,e){s===""?e(new Error("必须输入新密码")):e()},async submitForm(o){o&&await o.validate((s,e)=>{s?(this.changePwd(),o.resetFields()):console.log("提交错误!",e)})},resetForm(o){o&&o.resetFields()},async changePwd(){const o=await F.put("http://101.43.122.223:80/app/pwd/",{username:localStorage.getItem("username"),password:this.form.password,new_password:this.form.new_password},{headers:{Authorization:localStorage.getItem("token")}});o.data.code===200?_.success("修改成功"):_.error(`修改失败,${o.data.error}`)}}}),E={class:"Pwd"},S=g({__name:"Pwd",setup(o){const s=v(),e=C(),u=x({password:[{validator:e.validate_password,trigger:"change"}],new_password:[{validator:e.validate_new_password,trigger:"change"}],check__new_password:[{validator:e.validate_check_new_password,trigger:"change"}]});return(I,a)=>{const w=p("el-input"),l=p("el-form-item"),i=p("el-button"),c=p("el-form");return k(),V("div",E,[t(c,{ref_key:"pwdFormRef",ref:s,style:{"max-width":"600px"},model:r(e).form,rules:u,"label-width":"auto",class:"login-form"},{default:n(()=>[t(l,{prop:"password"},{default:n(()=>[t(w,{modelValue:r(e).form.password,"onUpdate:modelValue":a[0]||(a[0]=d=>r(e).form.password=d),type:"password",placeholder:"请输入密码","show-password":"","prefix-icon":r(y)},null,8,["modelValue","prefix-icon"])]),_:1}),t(l,{prop:"new_password"},{default:n(()=>[t(w,{modelValue:r(e).form.new_password,"onUpdate:modelValue":a[1]||(a[1]=d=>r(e).form.new_password=d),type:"password",placeholder:"请输入新密码","show-password":"","prefix-icon":r(m)},null,8,["modelValue","prefix-icon"])]),_:1}),t(l,{prop:"check__new_password"},{default:n(()=>[t(w,{modelValue:r(e).form.check__new_password,"onUpdate:modelValue":a[2]||(a[2]=d=>r(e).form.check__new_password=d),type:"password",placeholder:"请再次输入新密码","show-password":"","prefix-icon":r(m)},null,8,["modelValue","prefix-icon"])]),_:1}),t(l,null,{default:n(()=>[t(i,{type:"primary",onClick:a[3]||(a[3]=d=>r(e).submitForm(s.value))},{default:n(()=>[f("提交")]),_:1}),t(i,{onClick:a[4]||(a[4]=d=>r(e).resetForm(s.value))},{default:n(()=>[f("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}}),q=P(S,[["__scopeId","data-v-c4cc4907"]]);export{q as default};
