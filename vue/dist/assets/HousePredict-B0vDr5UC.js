import{v as U,U as I,E as V,d as C,r as B,x as N,a as R,q as y,k as p,t as x,f as r,e as n,w as u,b as c,o as _,K as g,L as b,i as k,p as $,j as E,c as v}from"./index-CplolMp0.js";import{r as z}from"./request-IMNDnQFT.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P=U("predict",{state:()=>({city_area:[],house_type_list:[],building_type_list:[],decoration_list:[],year_list:[],total_price:null,single_price:null,form:{city_area:"",house_type:"",building_type:"",decoration:"",year:"",house_size:null}}),actions:{async predict(){const o=I.service({lock:!0,text:"预测中",background:"rgba(0, 0, 0, 0.7)"}),e={Authorization:localStorage.getItem("token")},a={city:this.form.city_area[0],area:this.form.city_area[1],house_size:Number(this.form.house_size),house_type:this.form.house_type,decoration:this.form.decoration,building_type:this.form.building_type,year:this.form.year},l=await(await z.post("/app/predict/",a,{headers:e})).data;l&&(o.close(),l.code===200?(V.success("预测成功"),this.total_price=l.data.total_price,this.single_price=l.data.single_price):V.error("预测失败"))},async get_select_options(){const o={Authorization:localStorage.getItem("token")},a=(await z.get("app/options/",{headers:o})).data;if(a.code===200){for(let s in a.data.city_area_list){const l={},i=[];l.value=a.data.city_area_list[s].city,l.label=a.data.city_area_list[s].city;for(let m in a.data.city_area_list[s].areas){const d={};d.value=a.data.city_area_list[s].areas[m],d.label=a.data.city_area_list[s].areas[m],i.push(d)}l.children=i,this.city_area.push(l)}for(let s in a.data.house_type_list){const l={};l.value=a.data.house_type_list[s],l.label=a.data.house_type_list[s],this.house_type_list.push(l)}for(let s in a.data.building_type_list){const l={};l.value=a.data.building_type_list[s],l.label=a.data.building_type_list[s],this.building_type_list.push(l)}for(let s in a.data.decoration_list){const l={};l.value=a.data.decoration_list[s],l.label=a.data.decoration_list[s],this.decoration_list.push(l)}for(let s=1990;s<=2024;s++){const l={};l.label=`${s}年`,l.value=`${s}年`,this.year_list.push(l)}this.year_list.push({label:"其它年份",value:" "})}},validate_house_size(o,e,a){e===""?a(new Error("房屋面积必须输入")):/\b\d+(\.\d+)?\b/g.test(e)?a():a(new Error("房屋面积只能包含数字，不能包含字符"))},async submitForm(o){o&&(await o.validate((e,a)=>{e?this.predict():console.log("提交错误",a)}),o.resetFields())},resetForm(o){o&&o.resetFields()}},getters:{total_price_show(o){return o.total_price==null?"暂无数据":o.total_price},single_price_show(o){return o.single_price==null?"暂无数据":o.single_price}}}),F=o=>($("data-v-bb1c8dbc"),o=o(),E(),o),A={class:"predict"},H={class:"score"},M={class:"sing_price"},j=F(()=>p("span",{class:"title"},"单价:",-1)),D={class:"total_price"},K=F(()=>p("span",{class:"title"},"总价：",-1)),T=C({__name:"HousePredict",setup(o){const e=P(),a=B();N(()=>{e.city_area.length===0&&e.get_select_options()});const s=R({city_area:[{required:!0,message:"必须选择区域",trigger:"change"}],house_type:[{required:!0,message:"必须选择房屋类型",trigger:"change"}],building_type:[{required:!0,message:"必须选择房屋的建筑类",trigger:"change"}],decoration:[{required:!0,message:"必须选择房屋的装修程度",trigger:"change"}],house_size:[{validator:e.validate_house_size,trigger:"change"}],year:[{required:!0,message:"必须选择房屋的建造年份",trigger:"change"}]});return(l,i)=>{const m=c("el-cascader"),d=c("el-form-item"),h=c("el-option"),f=c("el-select"),S=c("el-input"),w=c("el-button"),q=c("el-form");return _(),y("div",A,[p("div",H,[p("div",M,[j,p("span",null,x(r(e).single_price_show)+"元/m2",1)]),p("div",D,[K,p("span",null,x(r(e).total_price_show)+"万/套",1)])]),n(q,{ref_key:"RegisterFormRef",ref:a,model:r(e).form,"label-width":"auto",rules:s,style:{"max-width":"600px"}},{default:u(()=>[n(d,{prop:"city_area"},{default:u(()=>[n(m,{options:r(e).city_area,clearable:"",style:{width:"240px"},modelValue:r(e).form.city_area,"onUpdate:modelValue":i[0]||(i[0]=t=>r(e).form.city_area=t),placeholder:"请选择区域"},null,8,["options","modelValue"])]),_:1}),n(d,{prop:"house_type"},{default:u(()=>[n(f,{modelValue:r(e).form.house_type,"onUpdate:modelValue":i[1]||(i[1]=t=>r(e).form.house_type=t),clearable:"",placeholder:"请选择房屋类型",style:{width:"240px"}},{default:u(()=>[(_(!0),y(g,null,b(r(e).house_type_list,t=>(_(),v(h,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,{prop:"building_type"},{default:u(()=>[n(f,{modelValue:r(e).form.building_type,"onUpdate:modelValue":i[2]||(i[2]=t=>r(e).form.building_type=t),clearable:"",placeholder:"请选择房屋的建筑类型",style:{width:"240px"}},{default:u(()=>[(_(!0),y(g,null,b(r(e).building_type_list,t=>(_(),v(h,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,{prop:"decoration"},{default:u(()=>[n(f,{modelValue:r(e).form.decoration,"onUpdate:modelValue":i[3]||(i[3]=t=>r(e).form.decoration=t),clearable:"",placeholder:"请选择房屋的装修程度",style:{width:"240px"}},{default:u(()=>[(_(!0),y(g,null,b(r(e).decoration_list,t=>(_(),v(h,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,{prop:"house_size"},{default:u(()=>[n(S,{modelValue:r(e).form.house_size,"onUpdate:modelValue":i[4]||(i[4]=t=>r(e).form.house_size=t),style:{width:"240px"},clearable:"",placeholder:"请输入房屋面积"},null,8,["modelValue"])]),_:1}),n(d,{prop:"year"},{default:u(()=>[n(f,{modelValue:r(e).form.year,"onUpdate:modelValue":i[5]||(i[5]=t=>r(e).form.year=t),clearable:"",placeholder:"请选择房屋的建造年份",style:{width:"240px"}},{default:u(()=>[(_(!0),y(g,null,b(r(e).year_list,t=>(_(),v(h,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(d,null,{default:u(()=>[n(w,{type:"primary",onClick:i[6]||(i[6]=t=>r(e).submitForm(a.value))},{default:u(()=>[k("点击预测")]),_:1}),n(w,{onClick:i[7]||(i[7]=t=>r(e).resetForm(a.value))},{default:u(()=>[k("取消")]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}}),Q=L(T,[["__scopeId","data-v-bb1c8dbc"]]);export{Q as default};
